!function(e){var t={};function s(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.m=e,s.c=t,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},s.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=49)}({132:function(e,t){},49:function(e,t,s){"use strict";s(132);var a=$(window).storager({key:"ycToken"}).readStorage();function o(e){return/\S+/.test(e)}new Vue({el:"#photoTask",data:{classArray:[],gradeArr:[],termArr:[],subjectArr:[],outlineArr:[],courseArr:[],courseId:"",gradeId:"",termId:"",subjectId:"",syllabusId:"",syllabusName:"",nodata:!1},filters:{addRootFile:function(e){return SERVERROOTFILE+e}},mounted:function(){var e=this;this.$nextTick(function(){e.init(),e.getClass(),e.initOutLine(),e.bindOutlineClick()})},methods:{init:function(){var e=this;$(".fe-arrangetask-pop #classes .classWrapper").on("click","div",function(){$(this).hasClass("active")?$(this).removeClass("active"):$(this).addClass("active")}),$("#zwb_upload").bindUpload({url:"http://zz.fetv.cn/YcE/ashx/upload/UploadFile.ashx?action=formDataUploadNew",callbackPath:"",num:8,type:"jpg|png|gif|svg",size:3}),parent.ECalendarisOpen1($("#endTime")),$(".fe-arrangetask-pop").on("click",".fe-save button",function(){if(""!=$("#paperName").val()){var t=$("#classes").find(".active");if(0!=t.length)if(o(e.syllabusId)){for(var s="",r=0;r<t.length;r++)s+=t[r].dataset.id,r!=t.length-1&&(s+=",");if(o(photoArray)){var n=layer.load(1,{shade:[.1,"#fff"]});$.ajax({async:!1,type:"post",url:SERVERROOTDATA+"api/teacher/site/homework.ashx?action=homeworkSave",data:{ycToken:a,photoArray:photoArray,paperType:"1",classify:"2",name:$("#paperName").val(),classId:s,courseId:e.courseId,endDate:$("#endTime").val(),saveTag:"add"},success:function(e){layer.close(n),200==res.body.code?(parent.layer.closeAll(),parent.location.reload()):layer.msg("布置失败")},error:function(e){alert(e)}}),photoArray=""}else layer.msg("请添加图片")}else layer.msg("请选择目录");else layer.msg("请选择班级")}else layer.msg("作业名称不能为空")})},getClass:function(){var e=this;this.$http.post(SERVERROOTDATA+"api/teacher/site/homework.ashx?action=getTeacherClass",{},{emulateJSON:!0}).then(function(t){200==t.body.code&&(e.classArray=t.body.rows)})},initOutLine:function(){var e=this;Promise.all([new Promise(function(t,s){e.$http.post(SERVERROOTDATA+"api/teacher/site/course.ashx?action=gradeList",{},{emulateJSON:!0}).then(function(s){200==s.body.code&&(e.gradeArr=s.body.rows,s.body.rows.length>0&&(e.gradeId=s.body.rows[0].gradeId)),t()}).then(function(){$("#grade").on("change",function(){e.gradeId=$(this).val(),e.getOutline(e.termId,e.gradeId,e.subjectId)})})}),new Promise(function(t,s){e.$http.post(SERVERROOTDATA+"api/teacher/site/course.ashx?action=subjectList",{},{emulateJSON:!0}).then(function(s){200==s.body.code&&(e.subjectArr=s.body.rows,s.body.rows.length>0&&(e.subjectId=s.body.rows[0].subjectId)),t()}).then(function(){$("#subject").on("change",function(){e.subjectId=$(this).val(),e.getOutline(e.termId,e.gradeId,e.subjectId)})})}),new Promise(function(t,s){e.$http.post(SERVERROOTDATA+"api/teacher/site/course.ashx?action=getTerm",{},{emulateJSON:!0}).then(function(s){200==s.body.code&&(e.termArr=s.body.rows,s.body.rows.length>0&&(e.termId=s.body.rows[0].id)),t()}).then(function(){$("#term").on("change",function(){e.termId=$(this).val(),e.getOutline(e.termId,e.gradeId,e.subjectId)})})})]).then(function(){e.$http.post(SERVERROOTDATA+"api/teacher/site/course.ashx?action=getNodes",{gradeId:e.gradeId,subjectId:e.subjectId,termId:e.termId},{emulateJSON:!0}).then(function(t){200==t.body.code&&(e.outlineArr=t.body.rows,t.body.rows.length<1?e.nodata=!0:e.nodata=!1)})})},getOutline:function(e,t,s){var a=this;a.$http.post(SERVERROOTDATA+"api/teacher/site/course.ashx?action=getNodes",{gradeId:t,subjectId:s,termId:e},{emulateJSON:!0}).then(function(e){200==e.body.code&&(a.outlineArr=e.body.rows,e.body.rows.length<1?a.nodata=!0:a.nodata=!1)})},bindOutlineClick:function(){var e=this;$(".catalog").on("click",".first>h4",function(){$(this).next("ul").children().length<1?(e.syllabusName=$(this).html(),e.syllabusId=$(this).data("id"),e.getCourse(e.syllabusId)):$(this).prev("i").hasClass("uk-icon-caret-down")?($(this).prev("i").removeClass(),$(this).prev("i").addClass("uk-icon-caret-right"),$(this).next("ul").slideUp()):($(this).prev("i").removeClass(),$(this).prev("i").addClass("uk-icon-caret-down"),$(this).next("ul").slideDown())}),$(".catalog").on("click",".second>li>h4",function(){$(this).next("ul").children().length<1?(e.syllabusName=$(this).html(),e.syllabusId=$(this).data("id"),e.getCourse(e.syllabusId)):$(this).prev("i").hasClass("uk-icon-caret-down")?($(this).prev("i").removeClass(),$(this).prev("i").addClass("uk-icon-caret-right"),$(this).next("ul").slideUp()):($(this).prev("i").removeClass(),$(this).prev("i").addClass("uk-icon-caret-down"),$(this).next("ul").slideDown())}),$(".catalog").on("click",".three h4",function(){e.syllabusName=$(this).html(),e.syllabusId=$(this).data("id"),e.getCourse(e.syllabusId)})},getCourse:function(e){var t=this;t.$http.post(SERVERROOTDATA+"api/teacher/site/homework.ashx?action=getTeacherCourse",{syllabusId:e},{emulateJSON:!0}).then(function(e){200==e.body.code&&(t.courseArr=e.body.rows)})}}})}});