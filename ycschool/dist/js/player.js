!function(e){var t={};function o(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},o.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=15)}({15:function(e,t,o){"use strict";o(98);var n=$(document).getUrlParam("vid"),a=$(document).getUrlParam("cid"),i=$(document).getUrlParam("time"),s=$(window).storager({key:"uIcon"}).readStorage(),l=$(window).storager({key:"uId"}).readStorage(),r="";isNaN(i)&&(i=0);new Vue({el:"#jplayerApp",data:{playauth:"",current:1,allpage:0,showItem:9,eval:"",evaluationList:[],evalCount:0,userIcon:"",relativeCourse:[],hasCollected:0,collectTitle:"收藏",collectLabel:"收藏"},filters:{addRootFile:function(e){return SERVERROOTFILE+e},gotoPlayer:function(e,t){return"player.html?cid="+e+"&vid="+t}},mounted:function(){this.$nextTick(function(){this.createAuth(),this.gettEvaluationList(),this.getRelativeCourse(),this.userIcon=s,this.isCollection(),this.alterCourseReadCount()})},computed:{pages:function(){var e=[];if(this.current<this.showItem)for(var t=Math.min(this.showItem,this.allpage);t;)e.unshift(t--);else{var o=this.current-Math.floor(this.showItem/2);for(t=this.showItem,o>this.allpage-this.showItem&&(o=this.allpage-this.showItem+1);t--;)e.push(o++)}return e},evalLen:function(){return this.eval.length}},methods:{createAuth:function(){var e=this;this.$http.post(SERVERROOTDATA+"/website/ashx/app/LearningWorld.ashx?action=getPlayUrlByVideoId",{videoId:n},{emulateJSON:!0}).then(function(t){200==t.body.code&&(e.playauth=t.body.rows[0].playAuth)}).then(function(){e.initPlayer()})},isCollection:function(){var e=this;this.$http.post(SERVERROOTDATA+"/website/ashx/site/OnlineClass.ashx?action=checkCourseHasCollected",{courseId:a},{emulateJSON:!0}).then(function(t){e.hasCollected=t.body.hasCollected,1==e.hasCollected?(e.collectTitle="取消收藏",e.collectLabel="已收藏"):(e.collectTitle="收藏",e.collectLabel="收藏")})},collectionCourse:function(){var e=this;1!=e.hasCollected?this.$http.post(SERVERROOTDATA+"api/student/site/Student.ashx?action=saveCollectionCourse",{cancel:0,courseId:a},{emulateJSON:!0}).then(function(e){200==e.body.code&&layer.msg("收藏成功!")}).then(function(){e.isCollection()}):this.$http.post(SERVERROOTDATA+"api/student/site/Student.ashx?action=saveCollectionCourse",{cancel:1,courseId:a},{emulateJSON:!0}).then(function(e){200==e.body.code&&layer.msg("取消收藏!")}).then(function(){e.isCollection()})},alterCourseReadCount:function(){this.$http.post(SERVERROOTDATA+"/website/ashx/site/OnlineClass.ashx?action=alterCourseReadCount",{courseId:a},{emulateJSON:!0})},initPlayer:function(){var e=this;new Aliplayer({id:"jcoursePlayer",width:"100%",height:"675px",autoplay:!0,vid:n,playauth:e.playauth,cover:"../images/public/player.jpg"},function(t){t.seek(i),r=setInterval(function(){e.playTimeLenSave(t.getCurrentTime())},1e4),t.on("play",function(){clearInterval(r),r=setInterval(function(){e.playTimeLenSave(t.getCurrentTime())},1e4)}),t.on("pause",function(){clearInterval(r),e.playTimeLenSave(t.getCurrentTime())})})},playTimeLenSave:function(e){this.$http.post(SERVERROOTDATA+"/website/ashx/site/OnlineClass.ashx?action=playTimeLenSave",{courseId:a,timeLen:e},{emulateJSON:!0})},gotoTeacher:function(e){window.open("teacherindex.html?teacherId="+e)},gettEvaluationList:function(){var e=this;this.$http.post(SERVERROOTDATA+"website/ashx/app/CourseEvaluation.ashx?action=getEvaluationList",{courseId:a,pageIndex:e.current,pageSize:6},{emulateJSON:!0}).then(function(t){200==t.body.code&&(e.evaluationList=t.body.rows,e.evalCount=t.body.totalCount,e.allpage=t.body.totalPageCount)})},subEval:function(){var e=this;return""==this.eval?(layer.msg("评论不能为空!"),!1):l?void this.$http.post(SERVERROOTDATA+"/website/ashx/app/CourseEvaluation.ashx?action=evaluation",{courseId:a,evaluation:e.eval},{emulateJSON:!0}).then(function(t){console.log(t.body),200==t.body.code&&(layer.msg(t.body.message),e.current=1,e.gettEvaluationList(),e.eval="")}):(layer.confirm("游客暂不能评论!",{btn:["登录","取消"]},function(){window.location.href="login.html"},function(){layer.closeAll()}),!1)},getRelativeCourse:function(){var e=this;this.$http.post(SERVERROOTDATA+"/website/ashx/site/OnlineClass.ashx?action=getRelativeCourse",{courseId:a,pageSize:4,pageIndex:1},{emulateJSON:!0}).then(function(t){200==t.body.code&&(e.relativeCourse=t.body.rows,e.relativeCourse.forEach(function(e,t){Vue.set(e,"teacherIconPath",SERVERROOTFILE+e.teacherIconPath)}))})},goto:function(e){if(e!=this.current){if(e>this.allpage)return this.current=this.current-2,layer.msg("Sorry ╮(╯_╰)╭ 没有下一页喽！"),!1;this.current=e,this.gettEvaluationList()}}}})},98:function(e,t){}});